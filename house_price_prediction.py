# -*- coding: utf-8 -*-
"""house price prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TPpjWEH41hPlxXSYBloKBn-PG4ag7R-7

# Importing the dependancies
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn.datasets
from sklearn.model_selection import train_test_split
from xgboost import XGBRegressor
from sklearn import metrics

"""# Importing the California House price dataset"""

from sklearn.datasets import fetch_california_housing
house_price_dataset = fetch_california_housing()
print(house_price_dataset)

#Loading the dataset to a pandas df
house_prediction_dataset = pd.DataFrame(house_price_dataset.data, columns = house_price_dataset.feature_names)
#print first 5 rows of our df
house_prediction_dataset.head()

#Add the target (price) column to the dataframe
house_prediction_dataset['Price'] = house_price_dataset.target
house_price_dataset.target_names

#Checking the number of rows and columns in the dataframe
house_prediction_dataset.shape

#check for missing values
house_prediction_dataset.isnull().sum()

# statistical measures of the dataset
house_prediction_dataset.describe()

"""# Understanding correlation between various features in dataset

1. Positive correlation
2. Negative correlation
"""

correlation = house_prediction_dataset.corr()
#constructing a heatmap to understand the correlation
plt.figure(figsize = (10,10))
sns.heatmap(correlation, cbar = True, square = True, fmt = '.1f', annot = True, annot_kws = {'size':8}, cmap = 'Blues')

"""# Splitting data and target"""

x = house_prediction_dataset.drop(['Price'], axis = 1)
y = house_prediction_dataset['Price']
print(x)
print(y)

"""# Split into train data and test data"""

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 2)
print(x.shape, x_train.shape, x_test.shape)

"""# Model Training

# XGBoost Regressor
"""

#Loading the model
model = XGBRegressor()
# training the model with x_train
model.fit(x_train, y_train)

"""# Evaluation

# Prediction on training data
"""

#accuracy for prediction on training data
training_data_prediction = model.predict(x_train)
print(training_data_prediction)

# R squared error
score_1 = metrics.r2_score(y_train, training_data_prediction)
# Mean absolute error
score_2 = metrics.mean_absolute_error(y_train, training_data_prediction)
print("R squared error : ", score_1)
print("Mean absolute error : ", score_2)

"""# Visualizing the actual prices and predicted prices"""

plt.scatter(y_train, training_data_prediction)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual Prices vs Predicted Prices")
plt.show()

"""# Prediction on test data"""

#accuracy for prediction on test data
test_data_prediction = model.predict(x_test)
print(test_data_prediction)

# R squared error
score_1 = metrics.r2_score(y_test, test_data_prediction)
# Mean absolute error
score_2 = metrics.mean_absolute_error(y_test, test_data_prediction)
print("R squared error : ", score_1)
print("Mean absolute error : ", score_2)